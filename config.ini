[Proxy]
# Main upstream resolver (Unbound on port 5335)
primary_dns = 127.0.0.1:5335

# Comma-separated fallback servers (public DNS providers)
fallback_dns_servers = 1.1.1.1, 1.0.0.1, 8.8.8.8, 9.9.9.9

# Address and port to listen on for DNS queries from Pi-hole
listen_address = 127.0.0.1
dns_port = 5355

# Health check configuration
health_check_interval = 10
health_check_domains = google.com, cloudflare.com, wikipedia.org, github.com

# File locations (ensure permissions are correct)
log_file = /var/log/dns-fallback.log
pid_file = /var/run/dns-fallback.pid

# Performance settings
buffer_size = 4096
max_workers = 50

# Enhanced timeout settings
# Shorter timeout for Unbound (local recursive resolver)
unbound_timeout = 1.5
# Longer timeout for fallback servers (public DNS over internet)
fallback_timeout = 3.0

# Intelligent caching and learning features
# Enable domain-specific fallback learning
intelligent_caching = true
# Maximum number of domains to track in cache
max_domain_cache = 1000
# Number of consecutive failures before bypassing Unbound for a domain
fallback_threshold = 3
# How long (in seconds) to bypass Unbound for a failing domain
bypass_duration = 3600

# Query optimization
# Enable deduplication of identical concurrent queries
enable_query_deduplication = true

# Logging configuration
# Enable structured JSON logging for better dashboard integration
structured_logging = true
